<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analysis Results - API Vigilance Tool</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Analysis Results</h1>
            <p class="subtitle">Comparison: {{ old_filename }} ‚Üí {{ new_filename }}</p>
        </header>

        <div class="results-section">
            <!-- Risk Score Card -->
            <div class="risk-score-card risk-{{ risk_info.risk_level.lower() }}">
                <div class="score-display">
                    <div class="score-number">{{ risk_score }}</div>
                    <div class="score-label">/ 10</div>
                </div>
                <div class="risk-badge">
                    <span class="badge badge-{{ risk_info.risk_level.lower() }}">
                        {{ risk_info.risk_level }} RISK
                    </span>
                </div>
                <p class="risk-message">{{ risk_info.message }}</p>
            </div>

            <!-- Recommended Actions -->
            <div class="recommendations-card">
                <h2>üìã Recommended Actions</h2>
                <p class="recommendation-text">{{ risk_info.reviewer_action }}</p>
            </div>

            <!-- Changes Detected -->
            <div class="changes-card">
                <h2>üîÑ Changes Detected</h2>

                {% if differences %}
                    <div class="changes-list">
                        {% for change in differences %}
                            <div class="change-item {% if change.type in ['endpoint-removed', 'method-removed', 'parameter-removed'] %}change-breaking{% else %}change-warning{% endif %}">
                                <div class="change-icon">
                                    {% if change.type in ['endpoint-removed', 'method-removed', 'parameter-removed'] %}
                                        ‚ö†Ô∏è
                                    {% else %}
                                        ‚ö°
                                    {% endif %}
                                </div>
                                <div class="change-details">
                                    <div class="change-type">{{ change.type | replace('-', ' ') | title }}</div>
                                    <div class="change-location">
                                        <span class="method-badge">{{ change.method | upper }}</span>
                                        <span class="path">{{ change.path }}</span>
                                    </div>
                                </div>
                                <div class="change-score">
                                    {% set score = {
                                        'endpoint-removed': 25,
                                        'method-removed': 20,
                                        'parameter-required-added': 15,
                                        'parameter-removed': 25
                                    }.get(change.type, 0) %}
                                    <span class="score-badge">{{ score }} pts</span>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-changes">
                        <p>‚úÖ No breaking changes detected!</p>
                        <p class="no-changes-subtitle">Your API changes appear to be safe.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Risk Level Guide -->
            <div class="guide-card">
                <h2>üìä Risk Level Guide</h2>
                <div class="guide-grid">
                    <div class="guide-item">
                        <span class="badge badge-low">LOW (1-3)</span>
                        <p>Routine changes, safe to merge</p>
                    </div>
                    <div class="guide-item">
                        <span class="badge badge-medium">MEDIUM (4-6)</span>
                        <p>Requires careful review and testing</p>
                    </div>
                    <div class="guide-item">
                        <span class="badge badge-high">HIGH (7-10)</span>
                        <p>Critical changes, requires multiple reviewers</p>
                    </div>
                </div>
            </div>

            <div class="actions">
                <a href="{{ url_for('index') }}" class="button button-primary">
                    ‚Üê Analyze Another Change
                </a>
            </div>
        </div>

        <footer>
            <p>Made with ‚ù§Ô∏è for API developers and product managers</p>
        </footer>
    </div>
</body>
</html>
